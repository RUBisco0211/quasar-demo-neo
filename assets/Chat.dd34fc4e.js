import{bJ as E,c as h,h as r,dl as J,a as O,r as p,aQ as x,a9 as B,aa as V,ah as e,bj as t,cH as _,da as $,c0 as W,c4 as m,c2 as k,ag as C,Y as M,aW as z,bl as Y,a7 as D,c5 as A,O as w,bH as F,H as L,cI as K,c1 as X}from"./index.93b2c2bb.js";import{Q as U}from"./QSpace.fcba7d79.js";import{Q as N}from"./QBtnGroup.e88eafa8.js";import{Q as j}from"./QToolbar.2ae5ce6f.js";import{Q as y,a as H,b as Z}from"./selection.e95cbf14.js";import{Q as R}from"./QImg.a9abb8d1.js";import{Q as ee}from"./QBadge.fb9fd29c.js";import{a as G}from"./TouchPan.8f92a69e.js";import{a as P}from"./QScrollArea.7ab4ba03.js";import{Q as ae}from"./QToolbarTitle.df305481.js";import{Q as te}from"./QSplitter.69010404.js";import{u as se}from"./user.7d81d0e9.js";var le=E({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup(s,{slots:o}){const v=h(()=>s.sent===!0?"sent":"received"),Q=h(()=>`q-message-text-content q-message-text-content--${v.value}`+(s.textColor!==void 0?` text-${s.textColor}`:"")),c=h(()=>`q-message-text q-message-text--${v.value}`+(s.bgColor!==void 0?` text-${s.bgColor}`:"")),f=h(()=>"q-message-container row items-end no-wrap"+(s.sent===!0?" reverse":"")),q=h(()=>s.size!==void 0?`col-${s.size}`:""),g=h(()=>({msg:s.textHtml===!0?"innerHTML":"textContent",stamp:s.stampHtml===!0?"innerHTML":"textContent",name:s.nameHtml===!0?"innerHTML":"textContent",label:s.labelHtml===!0?"innerHTML":"textContent"}));function S(i){return o.stamp!==void 0?[i,r("div",{class:"q-message-stamp"},o.stamp())]:s.stamp?[i,r("div",{class:"q-message-stamp",[g.value.stamp]:s.stamp})]:[i]}function b(i,n){const u=n===!0?i.length>1?l=>l:l=>r("div",[l]):l=>r("div",{[g.value.msg]:l});return i.map((l,d)=>r("div",{key:d,class:c.value},[r("div",{class:Q.value},S(u(l)))]))}return()=>{const i=[];o.avatar!==void 0?i.push(o.avatar()):s.avatar!==void 0&&i.push(r("img",{class:`q-message-avatar q-message-avatar--${v.value}`,src:s.avatar,"aria-hidden":"true"}));const n=[];o.name!==void 0?n.push(r("div",{class:`q-message-name q-message-name--${v.value}`},o.name())):s.name!==void 0&&n.push(r("div",{class:`q-message-name q-message-name--${v.value}`,[g.value.name]:s.name})),o.default!==void 0?n.push(b(J(o.default()),!0)):s.text!==void 0&&n.push(b(s.text)),i.push(r("div",{class:q.value},n));const u=[];return o.label!==void 0?u.push(r("div",{class:"q-message-label"},o.label())):s.label!==void 0&&u.push(r("div",{class:"q-message-label",[g.value.label]:s.label})),u.push(r("div",{class:f.value},i)),r("div",{class:`q-message q-message-${v.value}`},u)}}});const ne={class:"q-pa-md"},re={class:"row q-col-gutter-x-md justify-center"},oe={class:"col-12"},I=2,Ie=O({__name:"Chat",setup(s){const o=p(""),v=p(null),{getUserId:Q}=se(),c=Q(),f=h(()=>l=>({userId:l,avatar:"https://p3.itc.cn/images01/20230223/2fb863c6b58d445b826c03a4295044f4.jpeg",name:"GPT"})),q=l=>{const d=[];for(let a=0;a<l+10;a++)d.push({id:a+1,senderId:a%2===0?c:I,receiverId:a%2===1?c:I,sendTime:"2022-01-01 00:00:00",content:"hello"});return d},g=p([{sessionId:1,senderId:c,receiverId:I,messages:[],caption:"hello",star:!0},{sessionId:2,senderId:c,receiverId:I,messages:[],caption:"hello",star:!1},{sessionId:3,senderId:c,receiverId:I,messages:[],caption:"hello",star:!1}]),S=l=>{console.log("switch_star",l)},b=l=>{console.log("delete_session",l)},i=l=>{n.value!==l&&(n.value=l)},n=p(g.value[0]),u=p("");return(l,d)=>(x(),B("div",ne,[V("div",re,[V("div",oe,[e(K,{flat:"",style:{height:"calc(100vh - 63px - 2 * 16px)"}},{default:t(()=>[e(te,{modelValue:p(30).value,"onUpdate:modelValue":d[2]||(d[2]=a=>p(30).value=a),limits:[20,50]},{before:t(()=>[e(_,null,{default:t(()=>[e(j,{class:"q-mx-none q-px-none"},{default:t(()=>[e($,{rounded:"",outlined:"",placeholder:"\u641C\u7D22\u5386\u53F2\u5BF9\u8BDD...",dense:"",modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=a=>o.value=a)},{prepend:t(()=>[e(W,{name:"mdi-magnify",size:"xs"})]),_:1},8,["modelValue"]),e(U),e(N,{flat:""},{default:t(()=>[e(m,{flat:"",dense:"",round:"",icon:"mdi-reload"}),e(m,{flat:"",dense:"",round:"",icon:"mdi-plus"}),e(m,{flat:"",dense:"",round:"",icon:"mdi-notification-clear-all"})]),_:1})]),_:1})]),_:1}),e(k),e(_,{class:"q-pa-none"},{default:t(()=>[e(P,{style:{height:"calc(100vh - 63px - 2 * 16px - 82px)"}},{default:t(()=>[e(G,null,{default:t(()=>[e(y,{class:"q-mx-sm",header:""},{default:t(()=>[C("\u5386\u53F2\u5BF9\u8BDD")]),_:1}),(x(!0),B(M,null,z(g.value,a=>Y((x(),D(Z,{class:"q-mx-sm q-my-xs dense-menu-item",key:a.id,clickable:"",active:n.value.sessionId===a.sessionId,onClick:T=>i(a),"active-class":l.$q.dark.isActive?"bg-primary text-white":"bg-grey-4 text-dark"},{default:t(()=>[e(H,{avatar:""},{default:t(()=>[e(A,{size:"xl"},{default:t(()=>[e(R,{src:f.value(a.receiverId).avatar},null,8,["src"]),e(ee,{color:"positive",floating:"",rounded:"",label:"new"})]),_:2},1024)]),_:2},1024),e(H,null,{default:t(()=>[e(y,{class:"text-weight-bolder"},{default:t(()=>[C(w(f.value(a.userId).name),1)]),_:2},1024),e(y,{lines:"2",class:"ellipsis"},{default:t(()=>[C(w(a.caption),1)]),_:2},1024)]),_:2},1024),e(H,{side:""},{default:t(()=>[e(N,{flat:""},{default:t(()=>[e(m,{dense:"",flat:"",icon:a.star?"mdi-star":"mdi-star-outline",onClick:F(T=>S(a.senderId),["stop","prevent"])},null,8,["icon","onClick"]),e(m,{dense:"",flat:"",icon:"mdi-share-variant-outline"}),e(m,{dense:"",flat:"",icon:"mdi-trash-can-outline",onClick:F(T=>b(a.sessionId),["stop","prevent"])},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["active","onClick","active-class"])),[[X]])),128))]),_:1})]),_:1})]),_:1})]),after:t(()=>[e(_,null,{default:t(()=>[e(j,null,{default:t(()=>[e(A,{size:"xl"},{default:t(()=>[e(R,{src:f.value(n.value.receiverId).avatar},null,8,["src"])]),_:1}),e(ae,{class:"text-weight-bolder"},{default:t(()=>[C(w(f.value(L(c)).name),1)]),_:1}),e(U),e(m,{flat:"",round:"",color:"warning",icon:n.value.star?"mdi-star":"mdi-star-outline"},null,8,["icon"]),e(m,{flat:"",round:"",icon:"mdi-reload"})]),_:1})]),_:1}),e(k),e(_,{class:"q-pa-none"},{default:t(()=>[e(P,{style:{height:"calc(100vh - 63px - 2 * 16px - 72px - 82px)"},ref_key:"chatAreaRef",ref:v},{default:t(()=>[e(G,{class:"q-pa-lg"},{default:t(()=>[(x(!0),B(M,null,z(q(n.value.sessionId),a=>(x(),D(le,{key:a.id,text:[a.content],stamp:a.sendTime,sent:a.senderId===L(c),avatar:f.value(a.senderId).avatar,name:f.value(a.senderId).name},null,8,["text","stamp","sent","avatar","name"]))),128))]),_:1})]),_:1},512)]),_:1}),e(k),e(_,null,{default:t(()=>[e($,{placeholder:"\u8F93\u5165\u5185\u5BB9...",dense:"",rounded:"",outlined:"",modelValue:u.value,"onUpdate:modelValue":d[1]||(d[1]=a=>u.value=a)},{after:t(()=>[e(m,{flat:"",round:"",disable:!u.value||u.value.length===0,color:"primary",icon:"mdi-arrow-up"},null,8,["disable"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]))}});export{Ie as default};
