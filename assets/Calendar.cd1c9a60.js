import{a as U,r as h,c as b,aQ as r,a7 as v,bj as a,ah as t,cH as z,c0 as Q,M as Y,a8 as D,ag as i,O as E,c4 as d,H as A,c2 as I,bH as F,a9 as k,aW as q,Y as O,cI as K,d0 as W,K as J}from"./index.424da776.js";import{Q as N}from"./QToolbar.03d3f6c8.js";import{u as X,_ as Z,Q as ee}from"./FormItem.2ac45379.js";import{Q as _,a as V,b as te}from"./selection.9c7fe5b0.js";import{Q as p}from"./QTooltip.86b3841e.js";import{Q as H}from"./QBtnGroup.f568f983.js";import{a as ae}from"./TouchPan.f380c038.js";import{Q as G}from"./QToolbarTitle.c8ce3eb4.js";import{d as le}from"./QSelect.1e4868f6.js";import{Q as ue}from"./QSplitter.9a47ab3c.js";import{Q as oe}from"./index.esm.7f85f8f8.js";import{d as m}from"./date.fae5ae4c.js";import{u as ne}from"./use-quasar.c1d505a1.js";import{Q as ie}from"./QSpace.f67be330.js";import{Q as se}from"./QForm.46e42128.js";import{N as M}from"./notify.13a36a19.js";import"./QTabPanel.b16579db.js";import"./rtl.b51694b1.js";import"./QMenu.7611602c.js";import"./position-engine.4ffd6584.js";const j="YYYY-MM-DD HH:mm",re=U({__name:"ScheduleEditDialog",props:{type:{},value:{},onDeleteCallBack:{type:Function}},setup(R){const{dialogRef:g,onDialogCancel:f,onDialogOK:T}=X(),y=R,n=h(y.type),s=h({...y.value}),x=b(()=>({add:"\u65B0\u589E\u65E5\u7A0B",update:"\u4FEE\u6539\u65E5\u7A0B",detail:"\u65E5\u7A0B\u8BE6\u60C5"})[n.value]),S=h([{formItemType:"input",name:"title",type:"text",placeholder:"\u8BF7\u8F93\u5165\u65E5\u7A0B\u6807\u9898",label:"\u6807\u9898 *",icon:"eva-text-outline",rules:[e=>!!e&&e.length>0||"\u8BF7\u8F93\u5165\u65E5\u7A0B\u6807\u9898"]},{formItemType:"input",name:"content",type:"text",placeholder:"\u8BF7\u8F93\u5165\u65E5\u7A0B\u5185\u5BB9",label:"\u5185\u5BB9 *",icon:"eva-edit-2-outline",rules:[e=>!!e&&e.length>0||"\u8BF7\u8F93\u5165\u65E5\u7A0B\u5185\u5BB9"]},{formItemType:"dateTimePicker",name:"startTime",placeholder:"\u8BF7\u9009\u62E9\u65E5\u7A0B\u5F00\u59CB\u65F6\u95F4",label:"\u5F00\u59CB\u65F6\u95F4 *",icon:"mdi-clock-start",rules:[e=>!!e&&e.length>0||"\u8BF7\u9009\u62E9\u65E5\u7A0B\u5F00\u59CB\u65F6\u95F4"],mask:j,withSeconds:!1,dateOptions:e=>{if(!s.value.endTime)return!0;const l=m.adjustDate(new Date(e),{hour:0,minute:0,second:0,millisecond:0});return m.adjustDate(new Date(s.value.endTime),{hour:0,minute:0,second:0,millisecond:0}).getTime()>=l.getTime()}},{formItemType:"dateTimePicker",name:"endTime",placeholder:"\u8BF7\u9009\u62E9\u65E5\u7A0B\u7ED3\u675F\u65F6\u95F4",label:"\u7ED3\u675F\u65F6\u95F4 *",icon:"mdi-clock-end",withSeconds:!1,rules:[e=>!!e&&e.length>0||"\u8BF7\u9009\u62E9\u65E5\u7A0B\u7ED3\u675F\u65F6\u95F4",e=>{const l=new Date(s.value.startTime);return new Date(e).getTime()>=l.getTime()||"\u7ED3\u675F\u65F6\u95F4\u5E94\u665A\u4E8E\u5F00\u59CB\u65F6\u95F4"}],mask:j,dateOptions:e=>{if(!s.value.startTime)return!0;const l=m.adjustDate(new Date(s.value.startTime),{hour:0,minute:0,second:0,millisecond:0});return m.adjustDate(new Date(e),{hour:0,minute:0,second:0,millisecond:0}).getTime()>=l.getTime()}},{formItemType:"colorPicker",name:"color",label:"\u989C\u8272 *",icon:"eva-color-palette-outline",placeholder:"\u8BF7\u9009\u62E9\u989C\u8272",rules:[e=>!!e&&e.length>0||"\u8BF7\u9009\u62E9\u989C\u8272"]},{formItemType:"input",name:"url",type:"url",placeholder:"\u8BF7\u8F93\u5165\u65E5\u7A0B\u94FE\u63A5",label:"\u65E5\u7A0B\u94FE\u63A5",icon:"eva-link-2-outline",rules:[()=>!0]},{formItemType:"input",name:"location",type:"text",placeholder:"\u8BF7\u8F93\u5165\u65E5\u7A0B\u5730\u70B9",label:"\u5730\u70B9",icon:"eva-pin-outline",rules:[()=>!0]},{formItemType:"input",name:"notes",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u65E5\u7A0B\u5907\u6CE8",label:"\u5907\u6CE8",icon:"eva-clipboard-outline",rules:[()=>!0]}]),$=()=>{T({value:s.value,type:n.value})},B=()=>{s.value={...y.value}},o=()=>{const{onDeleteCallBack:e}=y;e&&e(y.value.scheduleId),f()};return(e,l)=>(r(),v(W,{ref_key:"dialogRef",ref:g,position:"right",maximized:"",persistent:""},{default:a(()=>[t(K,{style:{width:"500px"},flat:""},{default:a(()=>[t(z,null,{default:a(()=>[t(N,null,{default:a(()=>[s.value.color?(r(),v(Q,{key:0,name:"mdi-circle",style:Y({color:`${s.value.color}`})},null,8,["style"])):D("",!0),t(G,{class:"text-h6"},{default:a(()=>[i(E(x.value),1)]),_:1}),t(ie),n.value!=="add"?(r(),v(d,{key:1,round:"",icon:"eva-trash-outline",onClick:o,flat:"",color:"negative"},{default:a(()=>[t(p,null,{default:a(()=>[i("\u5220\u9664")]),_:1})]),_:1})):D("",!0),n.value==="detail"?(r(),v(d,{key:2,round:"",icon:"eva-edit-2-outline",onClick:l[0]||(l[0]=u=>n.value="update"),flat:""},{default:a(()=>[t(p,null,{default:a(()=>[i("\u4FEE\u6539")]),_:1})]),_:1})):D("",!0),n.value==="update"?(r(),v(d,{key:3,round:"",icon:"eva-eye-outline",onClick:l[1]||(l[1]=u=>n.value="detail"),flat:""},{default:a(()=>[t(p,null,{default:a(()=>[i("\u67E5\u770B\u8BE6\u60C5")]),_:1})]),_:1})):D("",!0),t(d,{round:"",icon:"eva-close-outline",onClick:A(f),flat:""},{default:a(()=>[t(p,null,{default:a(()=>[i("\u5173\u95ED")]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1}),t(I),t(se,{onSubmit:F($,["prevent"]),onReset:B},{default:a(()=>[t(z,{class:"q-pa-lg"},{default:a(()=>[(r(!0),k(O,null,q(S.value,u=>(r(),k("div",{key:u.name,class:"q-my-xs"},[t(Z,{item:u,readonly:n.value==="detail",modelValue:s.value[u.name],"onUpdate:modelValue":c=>s.value[u.name]=c},null,8,["item","readonly","modelValue","onUpdate:modelValue"])]))),128)),n.value==="add"||n.value==="update"?(r(),v(d,{key:0,type:"submit",label:"\u4FDD\u5B58",class:"q-mr-md",unelevated:"",icon:"eva-save-outline",color:"primary"})):D("",!0),n.value==="add"||n.value==="update"?(r(),v(d,{key:1,type:"reset",label:"\u91CD\u7F6E",outline:"",icon:"mdi-notification-clear-all",color:"primary"})):D("",!0)]),_:1})]),_:1})]),_:1})]),_:1},512))}}),de="#0277bd",ce="#ffa000",me="#9c27b0",pe="#1f1f1f",fe="#7cb342",ve="#ef5350",he="#73c0de",ye="#fac858";var w={primary:de,secondary:ce,accent:me,dark:pe,"dark-page":"#161616",positive:fe,negative:ve,info:he,warning:ye};const Te={class:"q-pa-md"},L="YYYY-MM-DD HH:mm",P="YYYY-MM-DD",Oe=U({__name:"Calendar",setup(R){const g=ne(),f=h(m.formatDate(new Date,P)),T=h(null),y=o=>{const e=m.formatDate(m.adjustDate(new Date(o.scope.timestamp.date),{hour:0,minute:0,second:0,millisecond:0}),L);n("add",{startTime:e})},n=(o,e)=>{g.dialog({component:re,componentProps:{type:o,value:e,onDeleteCallBack:s}}).onOk(l=>{const{value:u,type:c}=l;switch(c){case"add":console.log("add",u),M.successSingle("\u6DFB\u52A0\u6210\u529F");break;case"update":console.log("update",u),M.successSingle("\u4FEE\u6539\u6210\u529F");break}})},s=o=>{g.dialog({title:"\u786E\u8BA4",message:"\u786E\u8BA4\u5220\u9664\u8BE5\u65E5\u7A0B\u5417\uFF1F",cancel:!0,ok:!0,persistent:!0}).onOk(()=>{console.log("delete",o),M.successSingle("\u5220\u9664\u6210\u529F")})},x=b(()=>o=>B.value.filter(e=>{const l=new Date(e.startTime).getTime(),u=new Date(o).getTime(),c=m.addToDate(new Date(o),{day:1}).getTime();return!(new Date(e.endTime).getTime()<u||l>c)})),S=b(()=>o=>{for(const e of B.value){const l=new Date(e.startTime).getTime(),u=new Date(o).getTime(),c=m.addToDate(new Date(o),{day:1}).getTime();if(!(new Date(e.endTime).getTime()<u||l>c))return!0}return!1}),$=b(()=>(o,e)=>{const l=new Date(o.startTime).getTime(),u=new Date(o.endTime).getTime(),c=new Date(e).getTime(),C=m.addToDate(new Date(e),{day:1}).getTime();return l>=c&&l<=C?`${o.title} - ${o.startTime.split(" ")[1]}`:u>=c&&u<=C?`${o.title} - ${o.endTime.split(" ")[1]}`:o.title}),B=h([{scheduleId:123,title:"Schedule One",content:"This is the content for the first schedule.",startTime:"2024-04-15 09:30",endTime:"2024-04-19 11:00",star:!0,color:w.primary,allDay:!1,url:"https://example.com/schedule/one",location:"Conference Room A",notes:"Notes for the first schedule."},{scheduleId:456,title:"Schedule Two",content:"This is the content for the second schedule.",startTime:"2024-04-20 14:15",endTime:"2024-04-26 16:00",star:!1,color:w.accent,allDay:!1,url:"https://example.com/schedule/two",location:"Online Meeting",notes:"No additional notes for this schedule."},{scheduleId:789,title:"Schedule Three",content:"Details for the third schedule.",startTime:"2024-04-10 10:00",endTime:"2024-04-13 12:30",star:!1,color:w.secondary,allDay:!1,url:"https://example.com/schedule/three",location:"Training Room B",notes:"Important notes for the third schedule."},{scheduleId:999,title:"Schedule Ten",content:"Final schedule details.",startTime:"2024-04-25 13:45",endTime:"2024-04-27 15:15",star:!1,color:w.positive,allDay:!1,url:"https://example.com/schedule/ten",location:"Office Lobby",notes:"Reminder: Bring your laptop for this schedule."}]);return(o,e)=>(r(),k("div",Te,[t(K,{flat:""},{default:a(()=>[t(ue,{modelValue:h(20).value,"onUpdate:modelValue":e[6]||(e[6]=l=>h(20).value=l),limits:[20,20]},{before:a(()=>[t(N,{class:"q-pa-md"},{default:a(()=>[t(d,{unelevated:"",push:"",class:"full-width",dense:"",color:"primary",icon:"eva-plus-outline","no-caps":"",label:"\u6DFB\u52A0\u65E5\u7A0B",onClick:e[0]||(e[0]=l=>n("add",{startTime:A(m).formatDate(f.value,L)}))})]),_:1}),t(I),t(ee,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=l=>f.value=l),class:"full-width bg-transparent",minimal:"",mask:P,"years-in-month-view":"","first-day-of-week":"1",flat:"",events:S.value},null,8,["modelValue","events"]),t(I),t(ae,{separator:""},{default:a(()=>[t(_,{header:""},{default:a(()=>[i(" \u65E5\u7A0B\u5217\u8868 ")]),_:1}),(r(!0),k(O,null,q(B.value.sort((l,u)=>new Date(l.startTime).getTime()-new Date(u.startTime).getTime()),l=>(r(),v(te,{key:l.scheduleId},{default:a(()=>[t(V,{side:""},{default:a(()=>[t(Q,{size:"xs",name:"mdi-circle",style:Y({color:`${l.color}`})},null,8,["style"])]),_:2},1024),t(V,null,{default:a(()=>[t(_,{class:"text-h6"},{default:a(()=>[i(E(l.title),1)]),_:2},1024),t(_,null,{default:a(()=>[t(Q,{name:"eva-pin-outline",size:"16px"}),i(E(l.location),1)]),_:2},1024),t(_,null,{default:a(()=>[t(Q,{name:"eva-clock-outline",size:"16px"}),i(E(l.startTime),1)]),_:2},1024)]),_:2},1024),t(V,{side:""},{default:a(()=>[t(H,{flat:""},{default:a(()=>[t(d,{dense:"",flat:"",color:"primary",icon:"eva-eye-outline",onClick:F(u=>n("detail",l),["stop"])},{default:a(()=>[t(p,null,{default:a(()=>[i("\u67E5\u770B\u8BE6\u60C5")]),_:1})]),_:2},1032,["onClick"]),t(d,{dense:"",flat:"",color:"primary",icon:"eva-edit-2-outline",onClick:F(u=>n("update",l),["stop"])},{default:a(()=>[t(p,null,{default:a(()=>[i("\u4FEE\u6539")]),_:1})]),_:2},1032,["onClick"]),t(d,{dense:"",flat:"",color:"negative",icon:"eva-trash-outline",onClick:F(u=>s(l.scheduleId),["stop"])},{default:a(()=>[t(p,null,{default:a(()=>[i("\u5220\u9664")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),after:a(()=>[t(N,{class:"q-pa-md"},{default:a(()=>[t(H,{unelevated:""},{default:a(()=>[t(d,{dense:"",unelevated:"",icon:"eva-arrow-left-outline",onClick:e[2]||(e[2]=l=>T.value.prev())},{default:a(()=>[t(p,null,{default:a(()=>[i("\u4E0A\u4E2A\u6708")]),_:1})]),_:1}),t(d,{dense:"",unelevated:"",icon:"eva-arrow-right-outline",onClick:e[3]||(e[3]=l=>T.value.next())},{default:a(()=>[t(p,null,{default:a(()=>[i("\u4E0B\u4E2A\u6708")]),_:1})]),_:1}),t(d,{dense:"",unelevated:"",icon:"mdi-calendar-today-outline",onClick:e[4]||(e[4]=l=>T.value.moveToToday())},{default:a(()=>[t(p,null,{default:a(()=>[i("\u4ECA\u65E5")]),_:1})]),_:1})]),_:1}),t(G,null,{default:a(()=>[i(E(f.value),1)]),_:1})]),_:1}),t(I),t(A(oe),{animated:"",ref_key:"calendarRef",ref:T,locale:"zh-CN",modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=l=>f.value=l),weekdays:[1,2,3,4,5,6,0],"day-height":"200",class:J(A(g).dark.isActive?["bg-dark"]:["bg-white"]),onClickDay:y},{day:a(({scope:{timestamp:{date:l}}})=>[(r(!0),k(O,null,q(x.value(l),u=>(r(),v(le,{key:u.scheduleId,class:"full-width q-py-md",label:$.value(u,l),square:"",style:Y({"background-color":`${u.color}`,color:"white"}),onClick:F(c=>n("detail",u),["stop"]),clickable:""},null,8,["label","style","onClick"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["modelValue"])]),_:1})]))}});export{Oe as default};
